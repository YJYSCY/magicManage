import{_ as Y,r as o,o as z,c as m,a as u,b as $,d as P,e as f,w as p,E as H,F as X,f as D,n as j,g as v,h as M}from"./index-BFow_mbm.js";import{E as q,S as G,a as K,b as Q}from"./sortable.esm-BEIlbFJ3.js";const W={class:"drag-page"},Z={class:"area-box"},ee=["onClick"],le=["src"],te={class:"area-box"},ae=["onClick"],oe=["src"],r=5,se={__name:"bigMagicManage",setup(ne){const c=o([]),d=o([]),B=o(null),A=o(null),_=o(null),V=o(null),S=o(null),k=o(!1),I=o(!1),y=o(!1),b=o(""),w=o("A"),C=o(!1),x=o(""),E=a=>{x.value=a,C.value=!0},R=()=>{sessionStorage.setItem("smallMagicList",JSON.stringify(c.value)),sessionStorage.setItem("bigMagicList",JSON.stringify(d.value))},F=()=>{const a=JSON.parse(sessionStorage.getItem("smallMagicList")||"[]"),e=JSON.parse(sessionStorage.getItem("bigMagicList")||"[]");c.value=a.length?a:[],d.value=e.length?e:[]},h=a=>{w.value=a,b.value="",y.value=!0},J=()=>{if(!b.value)return;const a={id:Date.now(),url:b.value};w.value==="A"?c.value.push(a):d.value.push(a),R(),y.value=!1};function O(){document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden"}function T(a=50){setTimeout(()=>{document.body.style.overflow="",document.documentElement.style.overflow=""},a)}const U=(a,e,g)=>{G.create(a.value,{animation:150,group:"shared",forceFallback:!0,scroll:!1,onStart(s){const t=e.value[s.oldIndex];t&&(s.item.__dragId=t.id,V.value=t,S.value=g,k.value=!0,O())},onMove(s){if(!_.value)return;const t=s.originalEvent;let n,l;if(t?.clientX!=null)n=t.clientX,l=t.clientY;else if(t?.touches?.length)n=t.touches[0].clientX,l=t.touches[0].clientY;else{I.value=!1;return}const i=_.value.getBoundingClientRect();I.value=n>=i.left-r&&n<=i.right+r&&l>=i.top-r&&l<=i.bottom+r},onEnd(s){const t=s.originalEvent;if(s.from===s.to){const n=e.value.splice(s.oldIndex,1)[0];e.value.splice(s.newIndex,0,n)}if(k.value&&_.value&&t){const n=_.value.getBoundingClientRect(),l=t.clientX??t?.touches?.[0]?.clientX,i=t.clientY??t?.touches?.[0]?.clientY;if(l>=n.left-r&&l<=n.right+r&&i>=n.top-r&&i<=n.bottom+r){const N=s.item.__dragId;S.value==="A"?c.value=c.value.filter(L=>L.id!==N):d.value=d.value.filter(L=>L.id!==N)}}R(),V.value=null,S.value=null,k.value=!1,I.value=!1,T(60)}})};return z(()=>{F(),U(B,c,"A"),U(A,d,"B")}),(a,e)=>{const g=H,s=K,t=Q,n=q;return v(),m("div",W,[u("div",Z,[e[7]||(e[7]=u("h3",null,"Small Magic Cube",-1)),f(g,{type:"primary",size:"small",onClick:e[0]||(e[0]=l=>h("A"))},{default:p(()=>e[6]||(e[6]=[M("添加图片 URL 到 A")])),_:1,__:[6]}),u("div",{ref_key:"smallMagicListRef",ref:B,class:"img-list"},[(v(!0),m(X,null,D(c.value,l=>(v(),m("div",{key:l.id,class:"img-item",onClick:i=>E(l.url)},[u("img",{src:l.url,alt:""},null,8,le)],8,ee))),128))],512)]),u("div",te,[e[9]||(e[9]=u("h3",null,"区域 B",-1)),f(g,{type:"primary",size:"small",onClick:e[1]||(e[1]=l=>h("B"))},{default:p(()=>e[8]||(e[8]=[M("添加图片 URL 到 B")])),_:1,__:[8]}),u("div",{ref_key:"bigMagicListRef",ref:A,class:"img-list"},[(v(!0),m(X,null,D(d.value,l=>(v(),m("div",{key:l.id,class:"img-item",onClick:i=>E(l.url)},[u("img",{src:l.url,alt:""},null,8,oe)],8,ae))),128))],512)]),k.value?(v(),m("div",{key:0,ref_key:"deleteAreaRef",ref:_,class:j(["trash-area",{hover:I.value}])}," 🗑 ",2)):$("",!0),C.value?(v(),P(s,{key:1,"url-list":[x.value],onClose:e[2]||(e[2]=l=>C.value=!1)},null,8,["url-list"])):$("",!0),f(n,{title:`添加图片 URL 到 ${w.value==="A"?"A":"B"}`,modelValue:y.value,"onUpdate:modelValue":e[5]||(e[5]=l=>y.value=l)},{footer:p(()=>[f(g,{onClick:e[4]||(e[4]=l=>y.value=!1)},{default:p(()=>e[10]||(e[10]=[M("取消")])),_:1,__:[10]}),f(g,{type:"primary",onClick:J},{default:p(()=>e[11]||(e[11]=[M("确认")])),_:1,__:[11]})]),default:p(()=>[f(t,{modelValue:b.value,"onUpdate:modelValue":e[3]||(e[3]=l=>b.value=l),placeholder:"请输入图片 URL"},null,8,["modelValue"])]),_:1},8,["title","modelValue"])])}}},re=Y(se,[["__scopeId","data-v-7e7d52c9"]]);export{re as default};
